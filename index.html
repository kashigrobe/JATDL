<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo List</title>

    <!-- Materialize CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Materialize JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
</head>

<body class="container">

    <header>
        <h3 class="center-align">ToDo List </h3>
        <div class="center-align">
            <a id="newTaskBtn" class="waves-effect waves-light btn">New Task</a>
        </div>
    </header>

    <table id="taskTable" class="highlight centered responsive-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Email</th>
                <th>Title</th>
                <th>Description</th>
                <th>Due Date</th>
                <th>Completed</th>
            </tr>
        </thead>
        <tbody>
            <!-- The tasks will be rendered here -->
        </tbody>
    </table>
    <footer><a href="/register.html">Register</a> with us to get notified via mail on due dates.</footer>

    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Function to populate the table

            function populateTable(tasks) {
                const tableBody = document.getElementById('taskTable').querySelector('tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                tasks.forEach(task => {
                    const row = tableBody.insertRow();
                    row.insertCell(0).textContent = task.id;
                    row.insertCell(1).textContent = task.email;
                    row.insertCell(2).textContent = task.title;
                    row.insertCell(3).textContent = task.description;
                    row.insertCell(4).textContent = task.due_date;
                    row.insertCell(5).textContent = task.completed ? 'Yes' : 'No';
                });
            }

            // Fetch tasks when the page loads
            fetch('/api/getTasks')
                .then(response => response.json())
                .then(populateTable)
                .catch(console.error);


        });
    </script>
</body>

</html>